#include <stdio.h>

int main() {
    int n;

    printf("Enter number of processes: ");
    scanf("%d", &n);

    int bt[n], p[n], at[n], wt[n], tat[n];
    int rt[n]; // remaining time

    for (int i = 0; i < n; i++) {
        printf("\nProcess %d\n", i + 1);
        printf("Enter Arrival Time: ");
        scanf("%d", &at[i]);
        printf("Enter Burst Time: ");
        scanf("%d", &bt[i]);
        printf("Enter Priority (lower value = higher priority): ");
        scanf("%d", &p[i]);
        rt[i] = bt[i]; // initialize remaining time
    }

    int completed = 0, time = 0, smallest;
    int min_priority = 9999;

    while (completed != n) {
        smallest = -1;
        min_priority = 9999;

        // find highest priority among ready processes
        for (int i = 0; i < n; i++) {
            if (at[i] <= time && rt[i] > 0 && p[i] < min_priority) {
                min_priority = p[i];
                smallest = i;
            }
        }

        // if no process is ready, increase time
        if (smallest == -1) {
            time++;
            continue;
        }

        // execute the process for 1 unit (preemptive)
        rt[smallest]--;

        // if process finished
        if (rt[smallest] == 0) {
            completed++;
            int finish_time = time + 1;
            tat[smallest] = finish_time - at[smallest];
            wt[smallest] = tat[smallest] - bt[smallest];
        }

        time++;
    }

    // Display results
    printf("\n\n--- Pre-emptive Priority Scheduling Result ---\n");
    printf("P\tAT\tBT\tPR\tWT\tTAT\n");
    for (int i = 0; i < n; i++) {
        printf("P%d\t%d\t%d\t%d\t%d\t%d\n",
               i + 1, at[i], bt[i], p[i], wt[i], tat[i]);
    }

    return 0;
}
